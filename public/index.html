<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>üî¥ Neon Multi Live Monitor</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  background: radial-gradient(circle at top, #111 0%, #000 60%);
  color:#fff;
  font-family:Arial, sans-serif;
  margin:0;
  padding:20px;
}

h2 {
  color:#ff004c;
  text-shadow:0 0 10px #ff004c;
}

.support-banner {
  background:#111;
  border:1px solid #ff004c;
  padding:12px;
  border-radius:12px;
  margin-bottom:20px;
  text-align:center;
  box-shadow:0 0 15px #ff004c;
  font-weight:bold;
}

.controls {
  margin-bottom:15px;
}

.btn-main {
  padding:6px 12px;
  background:#00f7ff;
  border:none;
  border-radius:8px;
  cursor:pointer;
  color:black;
  font-weight:bold;
  margin-right:8px;
}

.tabs {
  display:flex;
  gap:10px;
  margin-bottom:20px;
  flex-wrap:wrap;
}

.tab {
  padding:8px 18px;
  background:#111;
  border:1px solid #333;
  border-radius:8px;
  cursor:pointer;
}

.tab.active {
  border-color:#ff004c;
  box-shadow:0 0 15px #ff004c;
  color:#ff004c;
}

.grid {
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:18px;
}

.card {
  background:#0d0d0d;
  border-radius:15px;
  padding:10px;
  border:1px solid #222;
  transition:0.3s;
}

.card:hover {
  transform:translateY(-5px);
  box-shadow:0 0 25px #00f7ff;
  border-color:#00f7ff;
}

iframe {
  width:100%;
  height:220px;
  border:none;
  border-radius:12px;
}

.info {
  font-size:13px;
  margin-top:10px;
}

.channel {
  font-weight:bold;
  color:#00f7ff;
}

.hide-btn, .unhide-btn {
  margin-top:8px;
  padding:5px 10px;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-size:11px;
}

.hide-btn {
  background:#ff004c;
  color:white;
}

.unhide-btn {
  background:#00f7ff;
  color:black;
  font-weight:bold;
}

.empty {
  opacity:0.6;
  padding:40px;
  font-size:18px;
  text-align:center;
  grid-column:1/-1;
}

@media (max-width:1024px) {
  .grid { grid-template-columns:repeat(2,1fr); }
}

@media (max-width:768px) {
  .grid { grid-template-columns:1fr; }
  iframe { height:260px; }
}
</style>
</head>

<body>

<h2>üî¥ Neon Multi Live Monitor</h2>

<div class="support-banner">
‚ù§Ô∏è Jangan lupa support para streamer ya plenger!
</div>

<div class="controls">
<button class="btn-main" onclick="toggleHiddenMode()">Toggle Hidden View</button>
<button class="btn-main" onclick="clearHidden()">Clear Hidden</button>
</div>

<div class="tabs" id="tabs"></div>
<div class="grid" id="grid"></div>

<script>

let dataStore = {};
let activeTag = null;
let showHiddenMode = false;
let hiddenVideos = JSON.parse(localStorage.getItem("hiddenVideos") || "[]");

async function loadLive(){
  const res = await fetch("/api/live");
  const newData = await res.json();
  dataStore = newData;
  renderTabs();
  if(activeTag){
    showCategory(activeTag);
  }
}

function renderTabs(){
  const tabs = document.getElementById("tabs");
  tabs.innerHTML = "";

  Object.keys(dataStore).forEach((tag, index) => {

    const btn = document.createElement("div");
    btn.className = "tab";
    btn.innerText = tag.toUpperCase();

    btn.onclick = () => {
      activeTag = tag;
      showCategory(tag);
      updateActiveTab();
    };

    if(index === 0 && !activeTag){
      activeTag = tag;
    }

    tabs.appendChild(btn);
  });

  updateActiveTab();
}

function updateActiveTab(){
  document.querySelectorAll(".tab").forEach(tab=>{
    tab.classList.remove("active");
    if(tab.innerText.toLowerCase() === activeTag){
      tab.classList.add("active");
    }
  });
}

function showCategory(tag){

  const grid = document.getElementById("grid");
  grid.innerHTML = "";

  const videos = dataStore[tag] || [];
  let displayed = 0;

  videos.forEach(video => {

    if(!video.videoId) return;

    const isHidden = hiddenVideos.includes(video.videoId);

    if(!showHiddenMode && isHidden){
      return;
    }

    displayed++;

    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <iframe src="https://www.youtube.com/embed/${video.videoId}?autoplay=1&mute=1" allowfullscreen></iframe>
      <div class="info">
        <div class="channel">${video.channelTitle}</div>
        <div>${video.title}</div>
        ${
          isHidden
          ? `<button class="unhide-btn" onclick="unhideVideo('${video.videoId}')">Unhide</button>`
          : `<button class="hide-btn" onclick="hideVideo('${video.videoId}')">Hide</button>`
        }
      </div>
    `;

    grid.appendChild(card);
  });

  if(displayed === 0){
    grid.innerHTML = `<div class="empty">üî¥ Tidak ada livestream aktif saat ini</div>`;
  }
}

function hideVideo(videoId){
  if(!hiddenVideos.includes(videoId)){
    hiddenVideos.push(videoId);
    localStorage.setItem("hiddenVideos", JSON.stringify(hiddenVideos));
  }
  showCategory(activeTag);
}

function unhideVideo(videoId){
  hiddenVideos = hiddenVideos.filter(id => id !== videoId);
  localStorage.setItem("hiddenVideos", JSON.stringify(hiddenVideos));
  showCategory(activeTag);
}

function toggleHiddenMode(){
  showHiddenMode = !showHiddenMode;
  showCategory(activeTag);
}

function clearHidden(){
  hiddenVideos = [];
  localStorage.removeItem("hiddenVideos");
  showCategory(activeTag);
}

loadLive();
setInterval(loadLive, 900000);

</script>

</body>
</html>
